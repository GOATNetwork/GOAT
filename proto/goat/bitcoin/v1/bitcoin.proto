syntax = "proto3";
package goat.bitcoin.v1;

import "amino/amino.proto";
import "cosmos_proto/cosmos.proto";
import "goat/relayer/v1/relayer.proto";
import "gogoproto/gogo.proto";

option go_package = "github.com/goatnetwork/goat/x/bitcoin/types";

// Deposit defines the deposit transaction and its proof
message Deposit {
  // block_number the block number that transaction located at
  uint64 block_number = 1;
  // block_header is a encoded bytes for a block header, it's always 80 bytes
  // refer to https://github.com/btcsuite/btcd/blob/master/wire/blockheader.go#L65 for the details
  bytes block_header = 2;
  // tx_index is the index of transaction in the block
  uint32 tx_index = 3;
  // tx is the raw transaction withtout witness
  bytes no_witness_tx = 4;
  uint32 output_index = 5;
  // intermediate proof is the proof without the txid and merkel root
  bytes intermediate_proof = 6;
  // evm_address is the user wallet address in goat evm
  bytes evm_address = 7;
  // relayer_pubkey is the compressed secp256k1 public key which managed by the relayer group
  goat.relayer.v1.PublicKey relayer_pubkey = 8;
}

// ExecuableDeposit
message ExecuableDeposit {
  bytes txid = 1;
  uint32 txout = 2;
  bytes address = 3;
  string amount = 4 [
    (cosmos_proto.scalar) = "cosmos.Int",
    (gogoproto.customtype) = "cosmossdk.io/math.Int",
    (gogoproto.nullable) = false,
    (amino.dont_omitempty) = true
  ];
}

// ExecuableWithdrawal
message ExecuableWithdrawalReceipt {
  uint64 id = 1;
  bytes txid = 2;
  uint32 txout = 3;
  string amount = 4 [
    (cosmos_proto.scalar) = "cosmos.Int",
    (gogoproto.customtype) = "cosmossdk.io/math.Int",
    (gogoproto.nullable) = false,
    (amino.dont_omitempty) = true
  ];
}

// ExecuableQueue
message ExecuableQueue {
  repeated bytes block_hash = 1;
  repeated ExecuableDeposit deposits = 2;
  repeated ExecuableWithdrawalReceipt paid_withdrawals = 3;
  repeated uint64 rejected_withdrawals = 4;
}
